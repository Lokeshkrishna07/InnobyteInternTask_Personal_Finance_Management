{% extends "base.html" %}
{% block title %}Login · Finance Tracker{% endblock %}
{% block content %}
<div class="auth">
  <h2>Welcome back</h2>
  <form class="form" id="loginForm">
    <label>Username
      <input name="username" placeholder="yourname" required>
    </label>
    <label>Password
      <input name="password" type="password" placeholder="••••••••" required>
    </label>
    <button class="btn primary" type="submit">Login</button>
    <p class="muted">No account? <a href="/register">Register</a></p>
  </form>
</div>
{% endblock %}
{% block scripts %}
<script>
document.getElementById('loginForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const f = e.target;
  const res = await fetch('/api/auth/login', {
    method:'POST', headers:{'Content-Type':'application/json'},
    body: JSON.stringify({username:f.username.value, password:f.password.value})
  });
  const j = await res.json();
  if(res.ok){ toast('Logged in'); location.href='/transactions'; }
  else{ toast(j.error || 'Login failed', 'error'); }
});
</script>
{% endblock %}
